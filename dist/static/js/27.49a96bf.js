(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{BV8L:function(t,e,o){},GIdh:function(t,e,o){"use strict";var r=o("BV8L");o.n(r).a},KmKK:function(t,e,o){"use strict";o.r(e);var r=o("6BQ9"),s=o.n(r),i=o("TbGu"),a=o.n(i),n=o("eVuF"),c=o.n(n),d=(o("eFdw"),o("b0p+")),l=o.n(d),m=o("3eXy"),u=o("v5wO"),h=o("nQ0s"),p=o("zWze"),f={components:{aqmOrdertime:l.a.aqmOrdertime,aqmShowpanel:l.a.aqmShowpanel,aqmSelectButton:l.a.aqmSelectButton,aqmNavbar:l.a.aqmNavbar,aqmCategoryL1:l.a.aqmCategoryL1,aqmPasswordPopcard:l.a.aqmPasswordPopcard,aqmAgreecheck:l.a.aqmAgreecheck,aqmConfirm:l.a.aqmConfirm,aqmVuxCheckIcon:l.a.aqmVuxCheckIcon},mixins:[p.a],data:function(){return{orderTimeText:{orderRisk:this.$t("order.risk_type_belong"),orderTitle:this.$t("order.introduce"),investText:this.$t("m_invest_type.estimate_amount"),submitText:this.$t("order.commit_time"),tradeText:this.$t("order.estimated_transaction_time"),settleText:this.$t("order.estimated_settle_time")},riskType:"",riskNameMap:{1:this.$t("result.risktype_1"),2:this.$t("result.risktype_2"),3:this.$t("result.risktype_3"),4:this.$t("result.risktype_4"),5:this.$t("result.risktype_5")},submitTime:"2018-07-10",tradeTime:"2018-07-11",settleTime:"2018-07-13",littleTitle:this.$t("m_invest_type.target_combination"),stockData:[],bondData:[],otherData:[],stockCg:this.$t("portfolio.stock"),bondCg:this.$t("portfolio.bond"),otherCg:this.$t("portfolio.other"),nameCode:this.$t("m_allocation.name_code"),investedAmount:"",investedAmountString:"",showPopCard:!1,adviceId:"",tradePassword:"",content1:this.$t("order.agree_content_hst"),checkValue:!1,showConfirm:!1,pwdErrorTip:"",cardSubTitle:this.$t("m_invest_type.build_acc"),cashType:"HKD",region:"HK",adviceType:"",canClick1:!0}},computed:{},watch:{},methods:{init:function(){var e=this;this.submitTime=Object(u.formatDate)(new Date),(this.$store.state.isHKUS||this.$store.state.isUS)&&(this.cashType="USD",this.region="US",this.orderTimeText.orderTitle=this.$t("order.introduce_us"),this.orderTimeText.investText=this.$t("m_invest_type.estimate_amount_us"));var o=this,r={};m.a.getAdviceActive().then(function(t){return"fromSupplement"==localStorage.getItem("fromSupplement")?m.a.getPortfolio():t&&0===t.length?(e.$alertBox(e.$t("m_allocation.no_advice")),console.log("getAdviceActive-order"),c.a.reject("services.getAdviceActive")):(202100===t[0].type?e.cardSubTitle=e.$t("m_invest_type.build_acc"):e.cardSubTitle=e.$t("m_invest_type.rebalance"),sessionStorage.getItem("fromQuestion")?(r=e.adviceFilter(t,202100,202200),sessionStorage.removeItem("fromQuestion")):r=e.adviceFilter.apply(e,[t,202100].concat(a()(h.c))),0<r.length?(r=r[0],e.adviceType=r.type,e.investedAmount=r.amount,e.adviceId=r.id,o.target=r.target,m.a.getPortfolio()):(e.$alertBox(e.$t("m_allocation.no_advice")),c.a.reject("noAdvice")))}).then(function(t){return t.expectedInvestedAmount&&2e5!==t.status&&(e.investedAmount=t.expectedInvestedAmount),"fromSupplement"==localStorage.getItem("fromSupplement")&&(e.investedAmount=t.value+ +localStorage.getItem("addValue")),e.$store.state.isHKUS||e.$store.state.isUS?e.investedAmountString="USD"+Vue.filter("formatMoney")(e.investedAmount):e.investedAmountString="HKD"+Vue.filter("formatMoney")(e.investedAmount),r&&r.type&&r.riskType?(e.riskType=r.riskType,e.riskScore=r.riskTolerance):(e.riskType=t.riskType,e.riskScore=t.riskScore),o.target||(o.target=t.target),e.showETFDetail(o.target,e.investedAmount)}).then(function(t){e.stockData=t.stockData,e.bondData=t.bondData,e.otherData=t.otherData}).catch(function(t){e.handleError(t),console.log(t)}),m.a.getTradeTime().then(function(t){e.tradeTime=t.date}).catch(function(t){e.handleError(t),console.log(t)}),m.a.getSettledTime().then(function(t){e.settleTime=t.date}).catch(function(t){e.handleError(t),console.log(t)})},addSuccess:function(){var e=this;if(this.canClick1){this.canClick1=!1,setTimeout(function(){this.canClick1=!0},2e3);var t={oid:localStorage.getItem("oid"),pid:localStorage.getItem("pid"),portfolioId:localStorage.getItem("p_id"),iaccountId:localStorage.getItem("i_id"),status:601e3,target:this.target,type:h.b.PORTFOLIO_REBALANCE_MORE_INVESTMENT,amount:+localStorage.getItem("addValue")};this.$vux.loading.show({text:"Loading"}),m.a.postAdvisor(t).then(function(){e.$vux.loading.hide(),e.$router.push("/portfolio")}).catch(function(t){e.$vux.loading.hide(),e.handleError(t)})}},confirmOrder:function(){var e=this;if(this.$store.commit("CHANGE_ALERT_COUNT",0),"fromSupplement"!=localStorage.getItem("fromSupplement"))if([h.b.PORTFOLIO_REBALANCE_DRIFT].indexOf(this.adviceType),this.$store.state.isUS){var t={answer:localStorage.getItem("answer"),persist:1},o=10*localStorage.getItem("riskRatio"),r=localStorage.getItem("riskType"),i=(localStorage.getItem("areaValue"),localStorage.getItem("industryValue"),{uid:s()(localStorage.getItem("uid"),10),region:"NON",sector:"NON",riskRatio:o,riskType:r,persist:1}),a=localStorage.getItem("redoAdvice");a?3===this.$store.state.prefrence?m.a.postPreference(i,this.adviceId).then(function(){m.a.postAdviceConfirm(a).then(function(t){e.$alertBox(e.$t("order.operation_success_1")+e.formatDateStringToWord(e.tradeTime)+e.$t("order.operation_success_2")),e.$router.push("/portfolio")}).catch(function(t){e.handleError(t)})}).catch(function(t){e.handleError(t),console.log(t)}):202200!==this.adviceType?m.a.postAdviceConfirm(a).then(function(t){e.$alertBox(e.$t("order.operation_success_1")+e.formatDateStringToWord(e.tradeTime)+e.$t("order.operation_success_2")),e.$router.push("/portfolio")}).catch(function(t){e.handleError(t)}):m.a.postAdviceAnswer(t,a).then(function(){m.a.postPreference(i,e.adviceId).then(function(){m.a.postAdviceConfirm(a).then(function(t){console.log(t),e.$alertBox(e.$t("order.operation_success_1")+e.formatDateStringToWord(e.tradeTime)+e.$t("order.operation_success_2")),e.$router.push("/portfolio")}).catch(function(t){e.handleError(t)})}).catch(function(t){e.handleError(t),console.log(t)})}).catch(function(t){e.handleError(t)}):m.a.postAdviceConfirm(this.adviceId).then(function(){e.$alertBox(e.$t("order.operation_success_1")+e.formatDateStringToWord(e.tradeTime)+e.$t("order.operation_success_2")),e.$router.push("/portfolio")}).catch(function(t){e.handleError(t)})}else m.a.postAdviceConfirm(this.adviceId).then(function(){e.$alertBox(e.$t("order.operation_success_1")+e.formatDateStringToWord(e.tradeTime)+e.$t("order.operation_success_2")),e.$router.push("/portfolio")}).catch(function(t){e.handleError(t)});else this.addSuccess()},cancelGiveup:function(){this.showConfirm=!this.showConfirm},confirmGiveup:function(){this.$router.push("forgetpassword")},resErrHandle:function(t){if(t&&t.status&&t.status.ecode){var e,o=t.status.ecode;if(this.pwdErrcounter=t.data.tran_try_count,21002===o)return 4===this.pwdErrcounter?this.pwdErrorTip=this.$t("info.err_pwd_over_4"):5===this.pwdErrcounter?this.pwdErrorTip=this.$t("info.err_pwd_over_5"):this.pwdErrorTip=this.$t("info.trade_error_note"),void(this.showConfirm=!0);if(e=t.data.trade_pwd_locked&&6<t.data.tran_try_count?this.$t("info.trade_pwd_locked"):this.$t("info.over_6"),21009===o){var r=this;return void this.$vux.alert.show({title:"",content:e,buttonText:this.$t("info.reset_pwd"),onShow:function(){console.log("Plugin: I'm showing")},onHide:function(){r.$router.push("/forgetpassword")}})}this.handleError(t),console.error(t)}console.error(t)},goBack:function(){this.$router.go(-1)},onPswFinishCard:function(t,e){this.tradePassword=t,this.confirmOrder()},onPswInputCard:function(t,e){},cardBottomBtnClick:function(t){console.log("card bottom click"),this.$router.push("forgetpassword")},cardClose:function(t){this.showPopCard=!1},onRadioChange:function(t){console.log("radio onchange data:".concat(t)),console.log("radio model data:".concat(this.radioModel))},btnClick:function(t){this.showPopCard=!0,this.$refs.order.scrollTop=0,this.confirmOrder()},formatDateStringToWord:function(t){var e=t.split("-");return e[0]+this.$t("order.year")+e[1]+this.$t("order.month")+e[2]+this.$t("order.day")}},mounted:function(){var t=this;this.$nextTick(function(){t.init()})},beforeRouteEnter:function(t,e,o){o(function(t){})},beforeDestroy:function(){localStorage.removeItem("fromSupplement"),localStorage.removeItem("addValue")}},_=(o("GIdh"),o("KHd+")),g=Object(_.a)(f,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"order",staticClass:"order-page",class:{"no-scroll":e.showPopCard}},[o("aqmNavbar",{attrs:{showClose:!0,value:e.$t("order.title"),showHelp:!0},on:{close:e.emitClose,goBack:e.goBack,goHelp:e.goFaq}}),e._v(" "),o("div",{staticClass:"wrap"},[o("aqmOrdertime",{attrs:{orderTimeText:e.orderTimeText,riskType:e.riskType?e.riskNameMap[e.riskType]:"--",investMoney:e.investedAmount,submitTime:e.submitTime,tradeTime:e.tradeTime,settleTime:e.settleTime}},[o("div",{staticClass:"tips-wrap",attrs:{slot:"aqm-ordertime-tips"},slot:"aqm-ordertime-tips"},[e.$store.state.isHKUS?o("span",{staticClass:"tips-icon",on:{click:function(t){}}},[o("span",{staticClass:"tips-cont",domProps:{innerHTML:e._s(e.$t("order.estimated_transaction_tips_us"))}})]):e.$store.state.isUS?o("span",{staticClass:"tips-icon",on:{click:function(t){}}},[o("span",{staticClass:"tips-cont",domProps:{innerHTML:e._s(e.$t("order.estimated_transaction_tips_qzt"))}})]):o("span",{staticClass:"tips-icon"},[o("span",{staticClass:"tips-cont",domProps:{innerHTML:e._s(e.$t("order.estimated_transaction_tips_hk"))},on:{click:function(t){}}})])])])],1),e._v(" "),o("div",{staticClass:"wrap"},[o("aqmCategoryL1",{attrs:{categoryText:e.littleTitle,underline:!1}}),e._v(" "),o("div",{staticClass:"recommand-list"},[o("aqmShowpanel",{attrs:{currency:e.cashType,region:e.region,itemMoney:e.$t("transfer.deposit_cash_value"),items:e.stockData,itemType:e.stockCg,itemNum:e.nameCode}}),e._v(" "),o("aqmShowpanel",{attrs:{currency:e.cashType,region:e.region,itemMoney:e.$t("transfer.deposit_cash_value"),items:e.bondData,itemType:e.bondCg,itemNum:e.nameCode}}),e._v(" "),o("aqmShowpanel",{attrs:{currency:e.cashType,region:e.region,itemMoney:e.$t("transfer.deposit_cash_value"),items:e.otherData,itemType:e.otherCg,itemNum:e.nameCode}})],1),e._v(" "),o("div",{staticClass:"order-state"},[o("p",[e._v(e._s(e.$t("m_invest_type.order_state")))])]),e._v(" "),o("div",{staticClass:"btn-agree-wrap"},[o("aqm-vux-check-icon",{attrs:{value:e.checkValue},on:{"update:value":function(t){e.checkValue=t}}},[o("span",[e._v(e._s(e.content1))])])],1),e._v(" "),o("aqmSelectButton",{staticClass:"order-btn",attrs:{fontSize:16,height:43,borderRadius:5,disabled:!e.checkValue,value:e.$t("order.confirm_order")},on:{click:e.btnClick}}),e._v(" "),o("aqmConfirm",{attrs:{showConfirm:e.showConfirm,confirmBtn:e.$t("info.reset_pwd"),cancelBtn:e.$t("m_forgetpwd.re_input"),confirmCont:e.pwdErrorTip},on:{cancel:e.cancelGiveup,confirm:e.confirmGiveup}})],1)],1)},[],!1,null,null,null);e.default=g.exports}}]);