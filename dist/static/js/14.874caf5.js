(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"9k/0":function(t,a,n){"use strict";n.r(a);var e=n("TbGu"),i=n.n(e),o=n("b0p+"),s=n.n(o),c=n("3eXy"),u=n("Yfch"),l=(n("nQ0s"),n("zWze")),r={components:{aqmNavbar:s.a.aqmNavbar,aqmVuxInput:s.a.aqmVuxInput,aqmCollapse:s.a.aqmCollapse,aqmVuxCheckIcon:s.a.aqmVuxCheckIcon,aqmVuxButton:s.a.aqmVuxButton,aqmTransferPopcard:s.a.aqmTransferPopcard},mixins:[l.a],data:function(){return{isAgree:!1,showPopCard:!1,textPanelHeight:250,hsAmount:"",iaccountAmount:"",addValue:"",inputValue:"",etfData:[],transferTips:"".concat(this.$t("hst.allocation_transfer_min"),"100,000.00").concat(this.$t("hst.allocation_transfer_hkd")),canClick:!0,canClick1:!0}},mounted:function(){var t=this;this.$nextTick(function(){t.init()})},methods:{init:function(){var a=this;c.a.getPortfolio().then(function(t){a.target=t.target,a.showETFDetail(a.target,0).then(function(t){a.etfData=[].concat(i()(t.stockData),i()(t.bondData),i()(t.otherData)),setTimeout(function(){a.textPanelHeight=a.$refs.textContainer.clientHeight},1)}).catch(function(t){a.handleError(t)})}).catch(function(t){a.handleError(t)})},onChange:function(){var t=this;this.$nextTick(function(){t.inputValue=t.formatValue(t.inputValue)})},goRiskState:function(){this.$router.push("/riskagreement")},limitMoney:function(){var t=this;this.$nextTick(function(){t.addValue=t.formatValue(t.addValue)})},changeMoney:function(){var a=this;console.log(this.addValue),this.showETFDetail(this.target,this.addValue).then(function(t){a.etfData=[].concat(i()(t.stockData),i()(t.bondData),i()(t.otherData)),setTimeout(function(){a.textPanelHeight=a.$refs.textContainer.clientHeight},1)}).catch(function(t){a.handleError(t)})},cardClose:function(){this.showPopCard=!1},confirmAdd:function(){var e=this;c.a.getCash().then(function(t){if(e.hsAmount=+t.HsAmount,e.iaccountAmount=+t.iaccountAmount,e.addValue=+e.addValue,e.addValue)if(Object(u.a)(e.addValue.toString()))if(+e.addValue<1e4)e.$vux.toast.show({text:e.$t("hst.toast9"),type:"text",width:"300px"});else if(+e.addValue>e.hsAmount+e.iaccountAmount){var a=e;e.$vux.confirm.show({title:e.$t("hst.allocation_insufficient"),content:e.$t("hst.allocation_insufficient_desc"),cancelText:e.$t("hst.allocation_insufficient_back"),confirmText:e.$t("hst.allocation_insufficient_deposit"),onCancel:function(){},onConfirm:function(){a.$router.push("/cashguide")}})}else if(+e.addValue>e.iaccountAmount){e.inputValue=e.addValue.toFixed(2),e.showPopCard=!0;var n=(e.addValue-e.iaccountAmount).toFixed(2);e.transferTips="".concat(e.$t("hst.allocation_transfer_min")).concat(n).concat(e.$t("hst.allocation_transfer_hkd")),e.iaccountAmount&&(e.transferTips="".concat(e.$t("hst.allocation_transfer_min2")).concat(e.$t("hst.allocation_transfer_min")).concat(n).concat(e.$t("hst.allocation_transfer_hkd")))}else localStorage.setItem("fromSupplement","fromSupplement"),localStorage.setItem("addValue",e.addValue),e.$router.push("/order");else e.$vux.toast.show({text:e.$t("transfer.money_not_valid"),type:"text",width:"300px"});else e.$vux.toast.show({text:"请输入金额",type:"text"})}).catch(function(t){e.handleError(t)})},back:function(){},confirm:function(){var a=this;if(this.canClick){if(!Object(u.a)(this.inputValue.toString()))return void this.$vux.toast.show({text:this.$t("transfer.money_not_valid"),type:"text",width:"230px"});if(this.inputValue=+this.inputValue,!this.inputValue)return void this.$vux.toast.show({text:"请输入划转金额",type:"text",width:"200px"});var t=(this.addValue-this.iaccountAmount).toFixed(2);if(+this.inputValue<t)return void this.$vux.toast.show({text:"".concat(this.$t("hst.allocation_transfer_min")).concat(t).concat(this.$t("hst.allocation_transfer_hkd")),type:"text",width:"300px"});if(+this.inputValue>this.hsAmount)return void this.$vux.toast.show({text:this.$t("hst.toast7"),type:"text",width:"300px"});this.$vux.loading.show({text:"Loading"}),this.canClick=!1,setTimeout(function(){this.canClick=!0},2e3),c.a.getCashIn(this.inputValue).then(function(t){t.flag&&(a.$vux.loading.hide(),a.$vux.toast.show({text:"转入成功",type:"text"}),a.showPopCard=!1)}).catch(function(t){a.$vux.loading.hide(),t&&t.status&&10117==t.status.ecode?a.$vux.alert.show({title:"",content:a.$t("hst.err_10117"),buttonText:a.$t("info.confirm"),onShow:function(){console.log("Plugin: I'm showing")},onHide:function(){}}):a.handleError(t)})}}}},h=(n("ZPw6"),n("KHd+")),d=Object(h.a)(r,function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"supplement"},[e("aqm-navbar",{attrs:{showClose:!0,value:n.$t("hst.supple_title"),showHelp:!0},on:{goBack:n.emitBack,close:n.emitClose,goHelp:n.goFaq}}),n._v(" "),e("div",{staticClass:"container"},[e("div",[e("aqm-vux-input",{attrs:{debounce:1e3,title:n.$t("hst.supple_title"),placeholder:n.$t("hst.supple_min")},on:{input:n.limitMoney,"on-change":n.changeMoney},model:{value:n.addValue,callback:function(t){n.addValue=t},expression:"addValue"}})],1),n._v(" "),e("div",{staticClass:"aqm-collase_wrap"},[e("aqm-collapse",{attrs:{title:n.$t("hst.supple_allo"),textPanelHeight:n.textPanelHeight}},[e("div",{attrs:{slot:"text"},slot:"text"},[e("div",{ref:"textContainer"},[e("div",{staticClass:"item subtitle"},[e("span",{staticClass:"rest"}),n._v(" "),e("span",{staticClass:"middle"},[n._v(n._s(n.$t("hst.supple_allo_prop")))]),n._v(" "),e("span",{staticClass:"last"},[n._v(n._s(n.$t("hst.supple_allo_amount")))])]),n._v(" "),e("ul",n._l(n.etfData,function(t,a){return e("li",{key:a,staticClass:"item"},[e("span",{staticClass:"rest"},[n._v(n._s(t.name))]),n._v(" "),e("span",{staticClass:"middle"},[n._v(n._s(t.percentage)+"%")]),n._v(" "),e("span",{staticClass:"last"},[n._v(n._s(n._f("formatMoney")(t.value)))])])}),0)])])])],1),n._v(" "),e("div",{staticClass:"icon-wrap"},[e("aqm-vux-check-icon",{attrs:{value:n.isAgree},on:{"update:value":function(t){n.isAgree=t}}},[e("span",[n._v(n._s(n.$t("hst.supple_agree ")))]),n._v(" "),e("span",{staticClass:"link",on:{click:n.goRiskState}},[n._v(n._s(n.$t("m_allocation.risk_state")))])])],1),n._v(" "),e("div",{staticClass:"btn-wrap",class:{disabled:!n.isAgree}},[e("aqm-vux-button",{nativeOn:{click:function(t){return n.confirmAdd(t)}}},[n._v(n._s(n.$t("hst.supple_submit")))])],1)]),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.showPopCard,expression:"showPopCard"}],staticClass:"mask-bg"},[e("div",{directives:[{name:"show",rawName:"v-show",value:n.showPopCard,expression:"showPopCard"}],staticClass:"pop-card-container"},[e("aqm-transfer-popcard",{attrs:{inputValue:n.inputValue,unit:n.$t("portfolio.hkd"),cardTitle:n.$t("hst.allocation_transfer"),cardText:n.$t("hst.allocation_transfer_desc"),buttonText:n.$t("hst.allocation_transfer_confirm"),tips:n.transferTips,onCardClose:n.cardClose},on:{onChange:n.onChange,"update:inputValue":function(t){n.inputValue=t},"update:input-value":function(t){n.inputValue=t},confirm:n.confirm}})],1)])],1)},[],!1,null,null,null);a.default=d.exports},XHBr:function(t,a,n){},Yfch:function(t,a,n){"use strict";n.d(a,"a",function(){return e});n("6BQ9");function e(t){return!(t&&!t.match(/^\d+(\.\d+)?$/))}},ZPw6:function(t,a,n){"use strict";var e=n("XHBr");n.n(e).a}}]);