(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"4kNx":function(t,e,a){"use strict";var n=a("CMGp");a.n(n).a},CMGp:function(t,e,a){},OFMk:function(t,e,a){"use strict";a.r(e);var n=a("TbGu"),r=a.n(n),o=a("9Jkg"),s=a.n(o),i=a("eVuF"),c=a.n(i),l=(a("eFdw"),a("b0p+")),u=a.n(l),m=a("zWze"),h=a("3eXy"),_=a("nQ0s"),f=a("9UV2"),p=a.n(f),d={components:{aqmBarchart:u.a.aqmBarchart,aqmAccountinfo:u.a.aqmAccountinfo,aqmPiechart:u.a.aqmPiechart,aqmAgreecheck:u.a.aqmAgreecheck,aqmState:u.a.aqmState,aqmSelectButton:u.a.aqmSelectButton,aqmPiestate:u.a.aqmPiestate,aqmNavbar:u.a.aqmNavbar,aqmCategoryL1:u.a.aqmCategoryL1,aqmAlert:u.a.aqmAlert,aqmConfirm:u.a.aqmConfirm,aqmVuxCheckIcon:u.a.aqmVuxCheckIcon},mixins:[m.a],data:function(){return{accountInfo:[{title:this.$t("result.value_need"),value:1e5},{title:this.$t("m_invest_type.accumulated_profit"),value:8e4}],checkValue:!1,deviation:this.$t("portfolio.drift"),driftValue:"",driftDetail:this.$t("difference.detail"),targetTitle:this.$t("m_invest_type.target_allo"),percentList:[],riskNameMap:{1:this.$t("result.risktype_1"),2:this.$t("result.risktype_2"),3:this.$t("result.risktype_3"),4:this.$t("result.risktype_4"),5:this.$t("result.risktype_5")},riskType:"",accumulatedReturnRate:0,ajustData:[],alertCont:this.$t("m_invest_type.why_drift_desc"),alertTitle:this.$t("m_invest_type.why_drift"),showAlert:!1,alertName:this.$t("m_invest_type.why_drift_noted"),compareDetail:this.$t("m_invest_type.allocation_compare"),showConfirm:!1,barChartText:[this.$t("m_invest_type.current_allocation"),this.$t("m_invest_type.after_allocation")],purchasePower:localStorage.getItem("purchasePower")||"--",showBack:!0}},computed:{},watch:{},methods:{init:function(){var n=this;(this.$store.state.isHKUS||this.$store.state.isUS)&&(this.accountInfo[0].title=this.$t("m_allocation.expected_invest_amount_us"),this.accountInfo[1].title=this.$t("portfolio.earn_total_us")),sessionStorage.removeItem("fromQuestion");var a={};c.a.all([h.a.getAdviceActive().then(function(t){return 0===(t=t.filter(function(t){return _.c.includes(t.type)})).length?(n.$alertBox(n.$t("m_invest_type.no_need_allo")),console.log("getAdviceActive-Tranp"),c.a.reject("noAdvice")):(a=t[t.length-1],h.a.getPortfolio())}).then(function(e){a&&a.type===_.b.PORTFOLIO_REBALANCE_INVESTMENT_TARGET_CHANGE?(n.riskType=a.riskType,n.riskScore=a.riskTolerance):(n.riskType=e.riskType,n.riskScore=e.riskScore),a&&a.type===_.b.PORTFOLIO_REBALANCE_MORE_INVESTMENT&&(n.alertCont=n.$t("m_invest_type.why_drift_desc2")),n.investedAmount=e.expectedInvestedAmount,n.accumulatedReturnRate=(100*e.twr_return).toFixed(2),n.driftValue="".concat(p.a.formatNumber(100*e.drift,2),"%"),e.value?e.value:e.expectedInvestedAmount,n.accountInfo[0].value=e.expectedInvestedAmount,n.accountInfo[1].value=e.accumulatedPl,n.showMarketUpdatedDetail(e.id,e.target,e.expectedInvestedAmount,!0).then(function(t){console.log(t),n.maxPercent=t.maxPercent,n.stockData=t.stockData,n.bondData=t.bondData,n.otherData=t.otherData,n.showETFDetail(e.target,e.expectedInvestedAmount).then(function(t){n.percentList=n.computePiePercent(t,self.investedAmount),setTimeout(function(){n.$refs.pieChart.startDraw(t.fundsValue)},100),n.maxPercent<t.maxPercent&&(n.maxPercent=t.maxPercent),t.stockData.forEach(function(e){var a=!1;n.stockData.forEach(function(t){e.id===t.id&&(n.$set(t,"target",e.percentage),a=!0)}),a||(n.$set(e,"target",e.percentage),n.$set(e,"percentage",0),n.stockData.push(e))}),n.stockData.forEach(function(t){t.target||n.$set(t,"target",0)}),console.log(n.stockData),n.stockData=n.stockData.filter(function(t){return!(0===t.target&&0===t.value)}),console.log(n.stockData),t.bondData.forEach(function(e){var a=!1;n.bondData.forEach(function(t){e.id===t.id&&(n.$set(t,"target",e.percentage),a=!0)}),a||(n.$set(e,"target",e.percentage),n.$set(e,"percentage",0),n.bondData.push(e))}),n.bondData.forEach(function(t){t.target||n.$set(t,"target",0)}),n.bondData=n.bondData.filter(function(t){return!(0===t.target&&0===t.value)}),t.otherData.forEach(function(e){var a=!1;n.otherData.forEach(function(t){e.id===t.id&&(n.$set(t,"target",e.percentage),a=!0)}),a||(n.$set(e,"target",e.percentage),n.$set(e,"percentage",0),n.otherData.push(e))}),n.otherData.forEach(function(t){t.target||n.$set(t,"target",0)}),n.otherData=n.otherData.filter(function(t){return!(0===t.target&&0===t.value)}),localStorage.setItem("stockData",s()(n.stockData)),localStorage.setItem("bondData",s()(n.bondData)),localStorage.setItem("otherData",s()(n.otherData)),n.ajustData=[].concat(r()(n.stockData),r()(n.bondData),r()(n.otherData)),console.log(n.ajustData),n.$refs.barChart.startDraw(n.ajustData)}).catch(function(t){n.handleError(t),console.log("获取Target失败",t)})}).catch(function(t){n.handleError(t),console.log(t)})}).catch(function(t){n.handleError(t),console.log(t)})]).then()},goReason:function(){this.showAlert=!0},back:function(){this.$router.push("/portfolio")},confirmAlert:function(){this.showAlert=!this.showAlert},goDetail:function(){this.$router.push("/transferdetail")},goRiskstate:function(){this.$router.push("/riskagreement")},cancelGiveup:function(){this.showConfirm=!this.showConfirm},confirmGiveup:function(){this.$router.push("/portfolio")},showComfirm:function(){this.showConfirm=!0},confirmTransfer:function(){this.$router.push("/order")}},mounted:function(){var t=this;this.$nextTick(function(){t.init()}),document.addEventListener("touchstart",function(){},!0)},beforeDestroy:function(){document.removeEventListener("touchstart",function(){},!0)}},v=(a("4kNx"),a("KHd+")),g=Object(v.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"trasfer-position-page"},[a("aqmNavbar",{attrs:{showClose:!0,value:e.$t("difference.title"),showHelp:!0},on:{goBack:e.back,close:e.emitClose,goHelp:e.goFaq}}),e._v(" "),a("div",{staticClass:"under-line"}),e._v(" "),a("div",{staticClass:"wrap"},[a("aqmAccountinfo",{attrs:{accountInfo:e.accountInfo}}),e._v(" "),a("div",{staticClass:"return-rate"},[a("div",{staticClass:"title"},[e._v(e._s(e.$t("summarybar.earn_radio"))+" "),a("span",{staticClass:"tips-icon"},[a("span",{staticClass:"tips-cont",domProps:{innerHTML:e._s(e.$t("summarybar.overview_returnRate_tip"))}})])]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.accumulatedReturnRate)+"%")])]),e._v(" "),a("p",{staticClass:"drif-state"},[e._v(e._s(e.$t("m_invest_type.why_drift"))),a("span",{on:{click:e.goReason}},[e._v(e._s(e.driftDetail))])])],1),e._v(" "),a("div",{staticClass:"under-line"}),e._v(" "),a("div",{staticClass:"wrap"},[a("aqmCategoryL1",{attrs:{categoryText:e.targetTitle,underline:!1}}),e._v(" "),a("div",[a("aqmPiechart",{ref:"pieChart",staticClass:"pie-chart",attrs:{type:e.$t("m_invest_type.risk_type"),typeName:e.riskNameMap[e.riskType]}}),e._v(" "),a("div",{staticClass:"pie-state"},[a("aqmPiestate",{attrs:{items:e.percentList}})],1)],1),e._v(" "),a("aqmBarchart",{ref:"barChart",attrs:{showTitle:!1,yDataTitle:e.$t("account.hired_income_resource_percent"),type:e.barChartText}}),e._v(" "),a("div",{staticClass:"under-line compare"})],1),e._v(" "),a("div",{staticClass:"wrap"},[a("span",{staticClass:"compare compare-left",on:{click:e.goDetail}},[a("aqmCategoryL1",{attrs:{categoryText:e.compareDetail,underline:!1}}),e._v(" "),a("i",{staticClass:"transfer-arrow"})],1)]),e._v(" "),a("div",{staticClass:"under-line"}),e._v(" "),a("div",{staticClass:"wrap"},[a("aqmState",{attrs:{stateName:e.$t("m_allocation.statement"),content:e.$t("m_allocation.statement_content")}}),e._v(" "),a("div",{staticClass:"btn-agree-wrap"},[a("aqm-vux-check-icon",{attrs:{value:e.checkValue},on:{"update:value":function(t){e.checkValue=t}}},[a("span",[e._v(e._s(e.$t("m_allocation.state_read")))]),e._v(" "),a("span",{staticClass:"link",on:{click:e.goRiskstate}},[e._v(e._s(e.$t("m_allocation.risk_state")))]),e._v(" "),a("span",[e._v(e._s(e.$t("m_allocation.state_agree")))])])],1),e._v(" "),a("aqmSelectButton",{staticClass:"order-btn",attrs:{fontSize:16,height:43,borderRadius:5,disabled:!e.checkValue,value:e.$t("transferPosition.confirm_allocation")},on:{click:e.confirmTransfer}}),e._v(" "),a("div",{staticClass:"give-up",on:{click:e.showComfirm}},[e._v(e._s(e.$t("difference.giveUp")))]),e._v(" "),a("aqmAlert",{attrs:{showAlert:e.showAlert,title:e.alertTitle,confirmBtn:e.alertName},on:{confirmAlert:e.confirmAlert}},[a("div",{staticClass:"alert-cont",attrs:{slot:"content"},slot:"content"},[a("p",[e._v(e._s(e.alertCont))]),e._v(" "),a("p",{staticClass:"transfer-state"},[e._v(e._s(e.$t("m_invest_type.why_drift_note")))])]),e._v("-\n    ")]),e._v(" "),a("aqmConfirm",{attrs:{showConfirm:e.showConfirm,confirmBtn:e.$t("m_allocation.rebalance_cancel_later"),cancelBtn:e.$t("m_allocation.rebalance_cancel_yes"),confirmCont:e.$t("m_allocation.rebalance_cancel_desc")},on:{cancel:e.confirmGiveup,confirm:e.cancelGiveup}})],1)],1)},[],!1,null,null,null);e.default=g.exports}}]);