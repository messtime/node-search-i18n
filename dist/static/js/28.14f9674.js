(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{EgR8:function(t,e,a){},OQlv:function(t,e,a){"use strict";a.r(e);var s=a("hfKm"),i=a.n(s),o=a("2Eek"),r=a.n(o),n=a("XoMD"),c=a.n(n),l=a("Jo+v"),u=a.n(l),d=a("4mXO"),h=a.n(d),f=a("pLtp"),v=a.n(f),_=a("eVuF"),p=a.n(_),m=a("xHqa"),w=a.n(m),C=a("6BQ9"),g=a.n(C),T=a("3eXy"),$=a("nQ0s"),y=(a("eFdw"),a("b0p+")),b=a.n(y),R=a("9UV2"),I=a.n(R),k=a("zWze"),P=a("v5wO");function O(e,t){var a=v()(e);if(h.a){var s=h()(e);t&&(s=s.filter(function(t){return u()(e,t).enumerable})),a.push.apply(a,s)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach(function(t){w()(e,t,a[t])}):c.a?r()(e,c()(a)):O(a).forEach(function(t){i()(e,t,u()(a,t))})}return e}var D,S,E=b.a.aqmHistoryChart,N=b.a.aqmAccountinfo,M=b.a.aqmPiechart,F=b.a.aqmPiestate,x={components:{aqmHistoryChart:E,aqmAccountinfo:N,aqmPiechart:M,aqmShowpanel:b.a.aqmShowpanel,aqmState:b.a.aqmState,aqmNavbar:b.a.aqmNavbar,aqmCategoryL1:b.a.aqmCategoryL1,aqmPiestate:F},mixins:[k.a],data:function(){return{stateName:this.$t("m_allocation.statement"),stateContent:this.$t("transfer.out_notice"),accountInfo:[{title:this.$t("m_invest_type.combination_value_hkd"),value:0}],titleTips:this.$t("hst.invest_acc_ordering"),history:this.$t("portfolio.menu2"),details:this.$t("m_invest_type.allocation_detail"),showOrderingTip:!1,stockData:[],bondData:[],otherData:[],pieData:"",percentList:[],stockCg:this.$t("portfolio.stock"),bondCg:this.$t("portfolio.bond"),otherCg:this.$t("portfolio.other"),nameCode:this.$t("m_allocation.name_code"),itemMoneyText:this.$t("transfer.deposit_cash_value"),riskNameMap:{1:this.$t("result.risktype_1"),2:this.$t("result.risktype_2"),3:this.$t("result.risktype_3"),4:this.$t("result.risktype_4"),5:this.$t("result.risktype_5")},riskType:"",accumulatedReturnRate:"0.00",marketUpdateTime:"",showRebalanceTip:!1,driftValue:"",driftWidth:0,hasPortfolio:!1,showInvest:!1,isFirstConstruction:!1,historyText:{historyOne:this.$t("m_portfolio.oneMonth"),historyThree:this.$t("m_portfolio.threeMonths"),historyOneYear:this.$t("m_portfolio.oneYear"),historyToNow:this.$t("m_portfolio.fromFirstDay"),historyCashIn:this.$t("historyChart.list_2"),historyAmout:"账户价值",historyValue:this.$t("historyChart.list_1"),historyEarn:this.$t("historyChart.list_3")},driftThreshold:localStorage.getItem("driftThreshold")||0,driftNumber:0,minFunding:g()(localStorage.getItem("minFunding"),10),accData:{},cashType:"HKD",region:"HK",driftDesc:this.$t("portfolio.drift_desc"),isShowInvestIn:!1,transferStep:2,purchasePower:"",unPaid:!1,accumulatedDebtAmount:"",accumulatedPl:0}},computed:{},watch:{},methods:{init:function(){var a=this;(this.$store.state.isHKUS||this.$store.state.isUS)&&(this.accountInfo[0].title=this.$t("portfolio.portfolio_value_us"),this.cashType="USD",this.region="US",this.driftDesc=this.$t("m_portfolio.drift_desc1")),T.a.getAdviceActive().then(function(t){0!==(t=t.filter(function(t){return $.c.includes(t.type)})).length&&(t[0].type===$.b.PORTFOLIO_REBALANCE_DRIFT&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0,a.overDrift=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_ALGO&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_INVESTMENT_TARGET_CHANGE&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_MORE_INVESTMENT&&(a.reason=a.$t("overflowMap.4"),a.detail=a.$t("difference.detail_4"),a.showRebalanceTip=!0,a.$store.state.isUS&&(a.isShowInvestIn=!0)),t[0].type===$.b.PORTFOLIO_REBALANCE_CASH_OUT&&(a.reason=a.$t("overflowMap.4"),a.detail=a.$t("difference.detail_4"),a.showRebalanceTip=!0))}).catch(function(t){a.handleError(t),console.log(t)}),T.a.getDefaultAcc().then(function(t){(a.accData=t).accumulatedDebtAmount&&(a.unPaid=!0,a.accumulatedDebtAmount=t.accumulatedDebtAmount),a.accumulatedPl=t.accumulatedPl,a.purchasePower=t.investableAmount,localStorage.setItem("purchasePower",a.purchasePower),localStorage.setItem("i_id",t.id),T.a.getPortfolio().then(function(t){return!t.id||2e5<=t.status?(a.hasPortfolio=!1,a.showInvest=!0,a.accumulatedReturnRate="--",a.portfolioRes=A({},t),a.portfolioRes.expectedInvestedAmount=null,console.log("getPortfolio-portfolio"),a.accountInfo[0].value=0,p.a.reject(!1)):(a.driftValue="".concat((100*t.drift).toFixed(2),"%"),a.driftNumber=t.drift,clearInterval(D),D=setInterval(a.autoUpdate,3e5),t.firstConstruction||(a.hasPortfolio=!0),a.algoModelId=t.target,a.portfolioRes=t,a.accumulatedReturnRate="".concat((100*t.twr_return).toFixed(2),"%"),a.riskIndex=t.riskScore,a.riskType=t.riskType,a.drift=100*t.drift,a.isFirstConstruction=t.isFirstConstruction,t.isFirstConstruction&&(a.itemMoneyText=a.$t("result.value_need"),a.driftValue="--",a.accumulatedReturnRate="--"),a.formatDrift(a.drift),t.marketUpdateTime?a.marketUpdateTime=Object(P.formatDate)(t.marketUpdateTime,"yyyy-MM-dd hh:mm:ss"):a.marketUpdateTime=!1,t.tradingStatus!==$.f.TRADING_IN_PROGRESS&&t.tradingStatus!==$.f.TRADING_WAIT||(a.showOrderingTip=!0),t.isFirstConstruction&&a.showOrderingTip&&(a.accountInfo[0].title=a.$store.state.isHKUS||a.$store.state.isUS?a.$t("result.value_need_sg"):a.$t("result.value_need")),t.tradingStatus===$.f.DONE_SUCCESS&&(console.log("交易完成"),a.showOrderingTip=!1),a.showMarketUpdatedDetail(t.id,t.target,t.expectedInvestedAmount))}).then(function(e){a.stockData=e.stockData.filter(function(t){return 0!==t.value}),a.bondData=e.bondData.filter(function(t){return 0!==t.value}),a.otherData=e.otherData.filter(function(t){return 0!==t.value}),a.pieData=e.fundsValue,S=setTimeout(function(){var t;a.percentList=a.computePiePercent(e,self.investedAmount),a.$refs.pieChart&&a.$refs.pieChart.startDraw(e.fundsValue),t=a.portfolioRes.value?a.portfolioRes.value:a.portfolioRes.expectedInvestedAmount,a.accountInfo[0].value=t,console.log(a.accountInfo),a.$refs.list&&a.$refs.list.startDraw(e,t)},100)}).catch(function(t){t&&(a.handleError(t),console.log(t))})}).catch(function(t){return a.handleError(t)})},goPage:function(t){this.$router.push(t)},cashOut:function(){},goFaq:function(){this.$router.push("/faq")},showHover:function(t){},hideHover:function(t){},autoUpdate:function(){var a=this;T.a.getAdviceActive().then(function(t){0!==(t=t.filter(function(t){return $.c.includes(t.type)})).length&&(t[0].type===$.b.PORTFOLIO_REBALANCE_DRIFT&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0,a.overDrift=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_ALGO&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_INVESTMENT_TARGET_CHANGE&&(a.reason=a.$t("overflowMap.5"),a.detail=a.$t("difference.detail_5"),a.showRebalanceTip=!0),t[0].type===$.b.PORTFOLIO_REBALANCE_MORE_INVESTMENT&&(a.reason=a.$t("overflowMap.4"),a.detail=a.$t("difference.detail_4"),a.showRebalanceTip=!0,a.$store.state.isUS&&(a.isShowInvestIn=!0)),t[0].type===$.b.PORTFOLIO_REBALANCE_CASH_OUT&&(a.reason=a.$t("overflowMap.4"),a.detail=a.$t("difference.detail_4"),a.showRebalanceTip=!0))}).catch(function(t){a.handleError(t),console.log(t)}),T.a.getDefaultAcc().then(function(t){(a.accData=t).accumulatedDebtAmount&&(a.unPaid=!0,a.accumulatedDebtAmount=t.accumulatedDebtAmount),a.accumulatedPl=t.accumulatedPl,a.purchasePower=t.investableAmount,localStorage.setItem("purchasePower",a.purchasePower),localStorage.setItem("i_id",t.id),T.a.getPortfolio().then(function(t){return!t.id||2e5<=t.status?(a.hasPortfolio=!1,a.showInvest=!0,a.accumulatedReturnRate="--",a.portfolioRes=A({},t),a.portfolioRes.expectedInvestedAmount=null,console.log("getPortfolio-portfolio"),a.accountInfo[0].value=0,p.a.reject(!1)):(a.driftValue="".concat((100*t.drift).toFixed(2),"%"),a.driftNumber=t.drift,t.firstConstruction||(a.hasPortfolio=!0),a.algoModelId=t.target,a.portfolioRes=t,a.accumulatedReturnRate="".concat((100*t.twr_return).toFixed(2),"%"),a.riskIndex=t.riskScore,a.riskType=t.riskType,a.drift=100*t.drift,a.isFirstConstruction=t.isFirstConstruction,t.isFirstConstruction&&(a.itemMoneyText=a.$t("result.value_need"),a.driftValue="--",a.accumulatedReturnRate="--"),a.formatDrift(a.drift),t.marketUpdateTime?a.marketUpdateTime=Object(P.formatDate)(t.marketUpdateTime,"yyyy-MM-dd hh:mm:ss"):a.marketUpdateTime=!1,t.tradingStatus!==$.f.TRADING_IN_PROGRESS&&t.tradingStatus!==$.f.TRADING_WAIT||(a.showOrderingTip=!0),t.isFirstConstruction&&a.showOrderingTip&&(a.accountInfo[0].title=a.$store.state.isHKUS||a.$store.state.isUS?a.$t("result.value_need_sg"):a.$t("result.value_need")),t.tradingStatus===$.f.DONE_SUCCESS&&(console.log("交易完成"),a.showOrderingTip=!1),a.showMarketUpdatedDetail(t.id,t.target,t.expectedInvestedAmount))}).then(function(e){a.stockData=e.stockData.filter(function(t){return 0!==t.value}),a.bondData=e.bondData.filter(function(t){return 0!==t.value}),a.otherData=e.otherData.filter(function(t){return 0!==t.value}),a.pieData=e.fundsValue,setTimeout(function(){var t;a.percentList=a.computePiePercent(e,self.investedAmount),a.$refs.pieChart&&a.$refs.pieChart.startDraw(e.fundsValue),t=a.portfolioRes.value?a.portfolioRes.value:a.portfolioRes.expectedInvestedAmount,a.accountInfo[0].value=t,console.log(a.accountInfo),a.$refs.list&&a.$refs.list.startDraw(e,t)},100)}).catch(function(t){t&&(a.handleError(t),console.log(t))})}).catch(function(t){return a.handleError(t)})},formatDrift:function(t){this.driftShowReal=!!t,t=I.a.formatNumber(t,2);var e=String(t).split(".");this.driftHigh=e[0],this.driftLow=e[1];var a=localStorage.getItem("driftThreshold");this.driftHigh>=100*a&&(this.overDrift=!0)},goTransfer:function(){this.$router.push("/transferposition")},goAllocation:function(){this.$router.push("/allocation")},goProfile:function(){location.href="".concat(window.location.origin,"/#/profile")},goBack:function(){this.$router.back()},checkIsShowClose:function(){console.log("0000000",this.$route)}},mounted:function(){var t=this;this.checkIsShowClose(),this.$nextTick(function(){t.init()}),document.addEventListener("touchstart",function(){},!0)},beforeDestroy:function(){document.removeEventListener("touchstart",function(){},!0),clearInterval(D),clearInterval(S)}},L=(a("YKoL"),a("KHd+")),q=Object(L.a)(x,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"portfolio-page"},[a("aqmNavbar",{attrs:{showClose:!0,value:e.$t("m_invest_type.invest_acc"),showBack:!1,showHelp:!0},on:{close:e.emitClose,goHelp:e.goFaq}}),e._v(" "),a("div",{staticClass:"portfolio-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showOrderingTip,expression:"showOrderingTip"}],staticClass:"title-tips",domProps:{innerHTML:e._s(e.titleTips)}}),e._v(" "),e.showOrderingTip?e._e():a("div",{staticClass:"tips-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.hasPortfolio,expression:"!hasPortfolio"}]},[e.showInvest?a("div",{staticClass:"need-balance"},[a("p",[e._v(e._s(e.$t("hst.invest_acc_guide")))]),e._v(" "),a("div",{staticClass:"balance-btn"},[a("button",{on:{click:e.goAllocation}},[e._v(e._s(e.$t("m_portfolio.get_started"))+"\n              "),e._m(0)])])]):e._e()]),e._v(" "),!e.isShowInvestIn&&e.showRebalanceTip&&e.hasPortfolio&&!e.showOrderingTip?a("div",{staticClass:"need-balance"},[a("p",[e._v(e._s(e.$t("m_invest_type.need_allocation")))]),e._v(" "),a("div",{staticClass:"balance-btn"},[a("button",{on:{click:e.goTransfer}},[e._v(e._s(e.$t("m_invest_type.start_allocation"))+"\n            "),e._m(1)])])]):e._e(),e._v(" "),e.isShowInvestIn?a("div",{staticClass:"need-balance"},[a("p",[e._v(e._s(e.$t("portfolio.no_portfolio_1")))]),e._v(" "),a("div",{staticClass:"balance-btn"},[a("button",{on:{click:e.goAllocation}},[e._v(e._s(e.$t("q.invest_now"))+"\n            "),e._m(2)])])]):e._e()]),e._v(" "),a("div",{staticClass:"cash-container"},[a("aqmCategoryL1",{attrs:{categoryText:e.$t("m_allocation.portfolio"),underline:!1}}),e._v(" "),a("aqmAccountinfo",{attrs:{accountInfo:e.accountInfo}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.unPaid,expression:"unPaid"}],staticClass:"return-rate cash-unpaid"},[a("div",{staticClass:"title"},[e._v(e._s(e.$t("hst.invest_acc_unpaid"))+"\n          "),a("a",{staticClass:"tips-icon",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.showHover(1)}}},[a("span",{staticClass:"tips-cont",on:{click:function(t){return e.hideHover(2)}}},[e._v(e._s(e.$t("hst.invest_acc_unpaid_desc")))])])]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e._f("formatMoney")(e.accumulatedDebtAmount)))])]),e._v(" "),a("div",{staticClass:"return-cash-wrap"},[a("div",{staticClass:"return-rate"},[a("div",{staticClass:"title"},[e._v(e._s(e.$t("m_invest_type.accumulated_profit"))+"\n          ")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e._f("formatMoney")(e.accumulatedPl)))])]),e._v(" "),a("div",{staticClass:"return-rate cash-rate"},[a("div",{staticClass:"title"},[e._v(e._s(e.$t("summarybar.earn_radio"))+"\n            "),a("span",{staticClass:"tips-icon",on:{click:function(t){return e.showHover(1)}}},[a("span",{staticClass:"tips-cont",on:{click:function(t){return e.hideHover(2)}}},[e._v(e._s(e.$t("summarybar.overview_returnRate_tip")))])])]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.accumulatedReturnRate))])]),e._v(" "),a("div",{staticClass:"return-rate cash-left"},[a("div",{staticClass:"title"},[e._v(e._s(e.$t("hst.invest_acc_cash"))+"\n            "),a("span",{staticClass:"tips-icon",on:{click:function(t){return e.showHover(1)}}},[a("span",{staticClass:"tips-cont"},[e._v(e._s(e.$t("hst.invest_acc_cash_desc")))])])]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e._f("formatMoney")(e.purchasePower)))])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.marketUpdateTime,expression:"marketUpdateTime"}],staticClass:"last-update"},[e._v(e._s(e.$t("portfolio.last_update_time"))+" :"),a("span",[e._v(e._s(e.marketUpdateTime))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.hasPortfolio&&!e.showOrderingTip,expression:"hasPortfolio && !showOrderingTip"}],staticClass:"under-line time-down-line"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.hasPortfolio&&!e.showOrderingTip,expression:"hasPortfolio && !showOrderingTip"}],staticClass:"cash-item-cont"},[a("div",{staticClass:"cash-item",on:{click:function(t){return e.goPage("/supplement")}}},[a("i",{staticClass:"cash-in"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.invest_acc_add")))])]),e._v(" "),a("div",{staticClass:"cash-item",on:{click:function(t){return e.goPage("/deposit")}}},[a("i",{staticClass:"cash-to-portfolio"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.invest_acc_cash_in")))])]),e._v(" "),a("div",{staticClass:"cash-item",on:{click:function(t){return e.goPage("/withdraw")}}},[a("i",{staticClass:"cash-to-acc"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.withdraw_title")))])]),e._v(" "),a("div",{staticClass:"cash-item",on:{click:function(t){return e.goPage("/sellposition")}}},[a("i",{staticClass:"cash-out"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.invest_acc_sell")))])])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showInvest,expression:"showInvest"}],staticClass:"cash-transfer-container"},[a("aqmCategoryL1",{attrs:{categoryText:e.$t("hst.invest_acc_transfer"),underline:!1}}),e._v(" "),a("div",{staticClass:"cash-transfer"},[a("div",{staticClass:"cash-transfer-item",on:{click:function(t){return e.goPage("/deposit")}}},[a("i",{staticClass:"cash-to-portfolio"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.invest_acc_cash_in")))])]),e._v(" "),a("span",{staticClass:"vertical-line"}),e._v(" "),a("div",{staticClass:"cash-transfer-item",on:{click:function(t){return e.goPage("/withdraw")}}},[a("i",{staticClass:"cash-to-acc"}),e._v(" "),a("p",[e._v(e._s(e.$t("hst.withdraw_title")))])])])],1),e._v(" "),e.hasPortfolio?a("div",{staticClass:"history-container"},[a("aqmCategoryL1",{attrs:{categoryText:e.details,underline:!1}}),e._v(" "),a("div",[a("aqmPiechart",{ref:"pieChart",staticClass:"pie-chart",attrs:{type:e.$t("m_invest_type.risk_type"),typeName:e.riskNameMap[e.riskType]}}),e._v(" "),a("div",{staticClass:"pie-state"},[a("aqmPiestate",{attrs:{items:e.percentList}}),e._v(" "),a("div",{staticClass:"drift-chart"},[a("p",[e._v(e._s(e.$t("portfolio.drift"))),a("span",{staticClass:"drift-icon",on:{click:function(t){return e.showHover(2)}}},[e._v("i"),a("span",{staticClass:"drift-state",on:{click:function(t){return e.hideHover(2)}}},[e._v(e._s(e.driftDesc))])]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isFirstConstruction,expression:"isFirstConstruction"}]},[e._v(e._s(e.driftValue))])]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstConstruction,expression:"!isFirstConstruction"}],staticClass:"base-line"}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstConstruction,expression:"!isFirstConstruction"}],staticClass:"drift-line",class:[e.driftThreshold<=e.driftNumber?"driff-over":""],style:{width:e.driftValue}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstConstruction,expression:"!isFirstConstruction"}],staticClass:"drift-value"},[e._v(e._s(e.driftValue))])])],1)],1),e._v(" "),a("div",{staticClass:"bond-item-wrap"},[a("aqmShowpanel",{attrs:{region:e.region,currency:e.cashType,items:e.stockData,itemType:e.stockCg,itemNum:e.nameCode,itemMoney:e.itemMoneyText}}),e._v(" "),a("aqmShowpanel",{attrs:{region:e.region,items:e.bondData,currency:e.cashType,itemType:e.bondCg,itemNum:e.nameCode,itemMoney:e.itemMoneyText}}),e._v(" "),a("aqmShowpanel",{attrs:{region:e.region,items:e.otherData,itemType:e.otherCg,currency:e.cashType,itemNum:e.nameCode,itemMoney:e.itemMoneyText}}),e._v(" "),a("aqmState",{directives:[{name:"show",rawName:"v-show",value:e.showOrderingTip,expression:"showOrderingTip"}],attrs:{stateName:e.stateName,content:e.stateContent}})],1)],1):e._e()]),e._v(" "),a("footer",{staticClass:"footer-tab"},[a("aqm-tabbar",{attrs:{menu:e.menu_p,activeBtn:1}})],1)],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"right-arrow"},[e("i")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"right-arrow"},[e("i")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"right-arrow"},[e("i")])}],!1,null,null,null);e.default=q.exports},YKoL:function(t,e,a){"use strict";var s=a("EgR8");a.n(s).a}}]);